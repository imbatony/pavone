# PAVOne v0.2.0 更新日志

## 🎉 主要特性

### Jellyfin 集成
- 新增 Jellyfin 服务器连接支持（用户名密码/API Key 认证）
- 实现 Jellyfin 搜索插件，可在媒体库中搜索视频
- 下载前自动检查视频是否已存在于 Jellyfin
- 新增 `jellyfin move` 命令，支持移动文件到 Jellyfin 库并自动刷新
- 新增 Jellyfin 库诊断工具，帮助排查配置问题
- 优化用户交互，使用 `click.confirm` 改进确认流程

### 元数据系统
- 新增 AV01 元数据提取器
- 实现 MemoJav、JTable 等多个元数据提取器
- 新增 `metadata enrich` 命令，支持从多个数据源增强 Jellyfin 视频元数据
- 完善元数据去重逻辑

### 插件整合
- 整合 AV01 插件，统一元数据提取和视频下载功能
- 合并 MissAV 插件实现，优化代码结构
- 移除插件系统中冗余的 execute 方法

## 🔧 改进优化

### 下载器优化
- 大幅改进 M3U8 下载器性能和稳定性
- 优化进度显示，提供更清晰的下载状态

### 日志系统重构
- 统一日志配置和格式化输出
- 将 print 语句替换为标准日志系统
- 改进错误处理和诊断信息

### 代码质量
- 统一代码质量工具配置（black、isort、flake8、pyright）
- 创建 `.flake8` 配置文件，统一 lint 规则
- 添加 pyright 到开发依赖，支持类型检查
- 配置 pytest 默认排除集成测试，加快开发反馈
- 修复 Pylance 类型检查错误
- 优化单元测试性能（部分测试加速 99.7%）
- 代码格式化（black、isort、flake8）
- 清理未使用的模块和导入
- 添加 C901 复杂度抑制注释到复杂但合理的函数

## 📚 文档更新
- 简化 README，重构开发文档至 `docs/dev/`
- 新增配置文档和使用指南
- 完善 Jellyfin 集成文档
- 创建开发工作流文档 `docs/dev/workflow.md`，详细说明本地开发流程

## 🛠️ 技术改进
- 升级 Pydantic 至 v2
- 优化 GitHub Actions 工作流，使用原生 uv 命令
- 重构 `dev.ps1` 开发脚本，新增完整 CI 流程支持（14个命令）
- 统一本地开发环境与 GitHub Actions 配置
- 改进项目配置文件（pyproject.toml、pyrightconfig.json、setup.cfg）
- 添加 setuptools 依赖，确保构建稳定性

## 🐛 修复
- 修复 Jellyfin 库文件夹获取逻辑
- 修复 MissAV 搜索插件正则表达式
- 修复元数据提取器 JavaScript 执行问题
- 改进目标文件夹逻辑，优先使用自定义文件名前缀
- 修复文件扩展名处理

## 📦 依赖更新
- 新增 `jellyfin-apiclient-python` - Jellyfin 官方 API 客户端
- 最低 Python 版本要求：3.10+
