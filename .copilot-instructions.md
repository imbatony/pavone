# GitHub Copilot 指令文件

## 🚨 首要规则 - 禁止事项

### ⛔ 绝对禁止

1. **❌ 不要创建任何新的 Markdown 文档文件** (除非用户明确要求)
   - 不要创建 CHANGELOG.md、SUMMARY.md、TODO.md 等
   - 不要创建任何总结性、记录性的文档
   - 完成工作后直接向用户汇报，不要写文档

2. **❌ 不要使用 pip 或 uv pip**
   - 禁止: `pip install`、`uv pip install`
   - 正确: `uv add package_name` (添加依赖)
   - 正确: `uv sync` (同步依赖)

3. **❌ 不要在 tests/ 目录外放置测试文件**
   - 所有测试必须在 `tests/` 文件夹
   - 不要在源代码目录创建测试文件

4. **❌ 不要为简单代码添加冗余注释**
   - 优先用清晰的命名表达意图
   - 只在逻辑复杂时添加中文注释

---

## 项目概述

**PAVOne** - Python 视频管理工具 (CLI，插件化架构)
- **语言**: Python 3.10+
- **依赖管理**: uv
- **CLI 框架**: Click
- **测试**: pytest

---

## 核心规范

### 代码风格
- **格式化**: Black (行长 88)
- **类型注解**: 强制使用
- **命名**: PascalCase (类)、snake_case (函数)、UPPER_SNAKE_CASE (常量)
- **文档字符串**: 使用中文，仅在必要时添加

### 插件架构
所有插件继承 `BasePlugin` 并实现标准接口

### 配置管理
使用 Pydantic 模型定义配置

### 依赖管理 (uv)
```bash
uv sync                    # 同步依赖
uv add package_name        # 添加依赖
uv add --dev pytest        # 添加开发依赖
uv run pytest              # 运行测试
```

---

## 项目结构

```
pavone/
├── cli/commands/     # CLI 命令
├── core/            # 核心功能 (下载器、元数据)
├── config/          # 配置管理
├── models/          # 数据模型
├── plugins/         # 插件系统
│   ├── extractors/  # 提取器插件
│   ├── search/      # 搜索插件
│   └── metadata/    # 元数据插件
└── utils/           # 工具函数

tests/               # 所有测试文件必须在此
```

---

## 常用命令

```bash
# 测试
uv run pytest tests/ -v

# 运行应用
uv run pavone [command]

# 格式化代码
black pavone/ tests/
```

---

## 快速参考

### 添加新插件
```python
from pavone.plugins.base import BasePlugin

class MyPlugin(BasePlugin):
    name = "my_plugin"
    version = "1.0.0"
    
    def initialize(self) -> bool:
        return True
```

### 添加新命令
```python
import click

@click.command()
@click.option('--param', help='参数说明')
def new_command(param: str):
    """命令描述"""
    pass
```

### 测试示例
```python
import pytest

def test_something():
    """测试某功能"""
    assert True
```

---

## ✅ 要做的事

1. 使用类型注解
2. 清晰的命名表达意图
3. 复杂逻辑添加中文注释
4. 测试文件放在 tests/
5. 使用 `uv add` 添加依赖
6. 使用 `with` 管理资源
7. 适当的错误处理

---

## ❌ 禁止做的事

1. **不要创建新的 .md 文档** (除非用户要求)
2. **不要使用 pip 或 uv pip** (只用 uv add)
3. **不要在 tests/ 外放测试文件**
4. 不要添加冗余注释和文档
5. 不要忽略类型错误
6. 不要硬编码配置
7. 不要使用过于宽泛的异常捕获
8. 不要修改全局状态

---

**更新**: 2025-12-29 | **维护**: PAVOne Team
